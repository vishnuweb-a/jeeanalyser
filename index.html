<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JEE 90-Day Intensive Preparation Tracker</title>
    <meta name="description" content="Complete your JEE syllabus in last 3 months with this daily tracker">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <style>
        /* All your existing CSS here - keep it exactly as you have it */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a237e 0%, #311b92 100%);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        h1 {
            color: #1a237e;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }

        .subtitle {
            color: #5c6bc0;
            font-size: 1.2rem;
            margin-bottom: 20px;
        }

        .date-display {
            background: #e8eaf6;
            padding: 10px 20px;
            border-radius: 10px;
            display: inline-block;
            font-weight: bold;
            color: #3949ab;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card i {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .stat-card.physics {
            border-top: 5px solid #ff5722;
        }

        .stat-card.chemistry {
            border-top: 5px solid #4caf50;
        }

        .stat-card.math {
            border-top: 5px solid #2196f3;
        }

        .stat-card.overall {
            border-top: 5px solid #9c27b0;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #1a237e;
            margin: 10px 0;
        }

        .stat-label {
            color: #5c6bc0;
            font-size: 1.1rem;
        }

        .tabs {
            display: flex;
            background: white;
            border-radius: 10px 10px 0 0;
            overflow: hidden;
            margin-bottom: 0;
        }

        .tab {
            flex: 1;
            text-align: center;
            padding: 15px;
            background: #e8eaf6;
            cursor: pointer;
            font-weight: bold;
            color: #5c6bc0;
            transition: all 0.3s;
        }

        .tab.active {
            background: white;
            color: #1a237e;
            border-bottom: 3px solid #1a237e;
        }

        .tab-content {
            display: none;
            background: white;
            border-radius: 0 0 15px 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .table-container {
            overflow-x: auto;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
        }

        th {
            background: #1a237e;
            color: white;
            padding: 15px;
            text-align: left;
            position: sticky;
            top: 0;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        tr:hover {
            background-color: #f1f3ff;
        }

        .day-number {
            font-weight: bold;
            color: #1a237e;
            text-align: center;
        }

        .completed {
            text-align: center;
        }

        .checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        input[type="text"]:focus, input[type="number"]:focus {
            border-color: #5c6bc0;
            outline: none;
        }

        .notes {
            font-size: 13px;
            color: #666;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            flex-wrap: wrap;
            gap: 15px;
        }

        button {
            padding: 12px 25px;
            background: #1a237e;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        button:hover {
            background: #283593;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        button.secondary {
            background: #5c6bc0;
        }

        button.export {
            background: #4caf50;
        }

        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .chart-title {
            margin-bottom: 20px;
            color: #1a237e;
            text-align: center;
            font-size: 1.5rem;
        }

        .chart-wrapper {
            height: 300px;
            position: relative;
        }

        .footer {
            text-align: center;
            color: white;
            padding: 20px;
            margin-top: 20px;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
        }

        .modal h2 {
            color: #1a237e;
            margin-bottom: 20px;
        }

        .close-modal {
            float: right;
            font-size: 28px;
            cursor: pointer;
            color: #777;
        }

        .close-modal:hover {
            color: #333;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: bold;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }

        .form-group textarea {
            height: 120px;
            resize: vertical;
        }

        .priority-high {
            color: #ff5722;
            font-weight: bold;
        }

        .priority-medium {
            color: #ff9800;
            font-weight: bold;
        }

        .priority-low {
            color: #4caf50;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .controls {
                flex-direction: column;
            }
            
            button {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .tab {
                padding: 12px 8px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>JEE 90-Day Intensive Preparation Tracker</h1>
            <p class="subtitle">Complete your syllabus in the last 3 months with this daily tracker</p>
            <div class="date-display" id="currentDate"></div>
        </header>

        <div class="stats-container">
            <div class="stat-card physics">
                <i class="fas fa-atom"></i>
                <div class="stat-value" id="physicsProgress">0%</div>
                <div class="stat-label">Physics Progress</div>
            </div>
            <div class="stat-card chemistry">
                <i class="fas fa-flask"></i>
                <div class="stat-value" id="chemistryProgress">0%</div>
                <div class="stat-label">Chemistry Progress</div>
            </div>
            <div class="stat-card math">
                <i class="fas fa-calculator"></i>
                <div class="stat-value" id="mathProgress">0%</div>
                <div class="stat-label">Mathematics Progress</div>
            </div>
            <div class="stat-card overall">
                <i class="fas fa-chart-line"></i>
                <div class="stat-value" id="overallProgress">0%</div>
                <div class="stat-label">Overall Progress</div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" data-tab="daily-tracker">Daily Tracker</div>
            <div class="tab" data-tab="syllabus">Syllabus Breakdown</div>
            <div class="tab" data-tab="progress">Progress Charts</div>
        </div>

        <div class="tab-content active" id="daily-tracker">
            <div class="controls">
                <button id="addTopicBtn">
                    <i class="fas fa-plus"></i> Add Topic to Syllabus
                </button>
                <button class="secondary" id="resetBtn">
                    <i class="fas fa-redo"></i> Reset All Data
                </button>
                <button class="export" id="exportBtn">
                    <i class="fas fa-file-export"></i> Export Data
                </button>
            </div>
            <div class="table-container">
                <table id="trackerTable">
                    <thead>
                        <tr>
                            <th>Day</th>
                            <th>Date</th>
                            <th>Day</th>
                            <th>Physics Topics</th>
                            <th>Chemistry Topics</th>
                            <th>Mathematics Topics</th>
                            <th>Daily Target</th>
                            <th>Completed</th>
                            <th>Hours</th>
                            <th>Mock Score</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody id="trackerBody">
                        <!-- Days will be generated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <div class="tab-content" id="syllabus">
            <div class="controls">
                <button id="addSyllabusBtn">
                    <i class="fas fa-plus"></i> Add Syllabus Topic
                </button>
            </div>
            <div class="table-container">
                <table id="syllabusTable">
                    <thead>
                        <tr>
                            <th>Topic</th>
                            <th>Subject</th>
                            <th>Priority</th>
                            <th>Est. Days</th>
                            <th>Start Date</th>
                            <th>End Date</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="syllabusBody">
                        <!-- Syllabus topics will be added here -->
                    </tbody>
                </table>
            </div>
        </div>

        <div class="tab-content" id="progress">
            <div class="chart-container">
                <h3 class="chart-title">Daily Study Hours</h3>
                <div class="chart-wrapper">
                    <canvas id="hoursChart"></canvas>
                </div>
            </div>
            <div class="chart-container">
                <h3 class="chart-title">Subject-wise Progress</h3>
                <div class="chart-wrapper">
                    <canvas id="progressChart"></canvas>
                </div>
            </div>
        </div>

        <div class="modal" id="topicModal">
            <div class="modal-content">
                <span class="close-modal">&times;</span>
                <h2>Add Topic to Syllabus</h2>
                <form id="topicForm">
                    <div class="form-group">
                        <label for="topicName">Topic Name</label>
                        <input type="text" id="topicName" required placeholder="e.g., Organic Chemistry, Mechanics, Calculus">
                    </div>
                    <div class="form-group">
                        <label for="topicSubject">Subject</label>
                        <select id="topicSubject" required>
                            <option value="">Select Subject</option>
                            <option value="Physics">Physics</option>
                            <option value="Chemistry">Chemistry</option>
                            <option value="Mathematics">Mathematics</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="topicPriority">Priority</label>
                        <select id="topicPriority" required>
                            <option value="">Select Priority</option>
                            <option value="High">High</option>
                            <option value="Medium">Medium</option>
                            <option value="Low">Low</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="topicDays">Estimated Days Required</label>
                        <input type="number" id="topicDays" min="1" max="30" value="5" required>
                    </div>
                    <div class="form-group">
                        <label for="topicNotes">Notes (Optional)</label>
                        <textarea id="topicNotes" placeholder="Any additional notes about this topic..."></textarea>
                    </div>
                    <button type="submit">Add Topic</button>
                </form>
            </div>
        </div>

        <div class="footer">
            <p>JEE 90-Day Preparation Tracker | Designed for Intensive Last 3 Months Preparation</p>
            <p>Data is saved automatically in your browser's local storage</p>
        </div>
    </div>

    <script>
        // Initialize data and charts
        document.addEventListener('DOMContentLoaded', function() {
            // Set current date
            const now = new Date();
            document.getElementById('currentDate').textContent = now.toDateString();
            
            // Initialize app
            initApp();
            setupEventListeners();
            generateTrackerDays();
            loadData();
            updateProgress();
            renderCharts();
        });

        // Application state
        const appState = {
            currentDay: 1,
            totalDays: 90,
            syllabus: [],
            trackerData: [],
            studyHours: []
        };

        // Sample syllabus for initial load
        const sampleSyllabus = [
            { id: 1, name: "Mechanics", subject: "Physics", priority: "High", days: 10, start: "", end: "", status: "Not Started", notes: "" },
            { id: 2, name: "Organic Chemistry", subject: "Chemistry", priority: "High", days: 12, start: "", end: "", status: "Not Started", notes: "" },
            { id: 3, name: "Calculus", subject: "Mathematics", priority: "High", days: 15, start: "", end: "", status: "Not Started", notes: "" },
            { id: 4, name: "Electrodynamics", subject: "Physics", priority: "Medium", days: 8, start: "", end: "", status: "Not Started", notes: "" },
            { id: 5, name: "Coordination Chemistry", subject: "Chemistry", priority: "Medium", days: 7, start: "", end: "", status: "Not Started", notes: "" },
            { id: 6, name: "Algebra", subject: "Mathematics", priority: "High", days: 12, start: "", end: "", status: "Not Started", notes: "" }
        ];

        // Initialize the application
        function initApp() {
            // Load data from localStorage or initialize with defaults
            const savedSyllabus = localStorage.getItem('jeeSyllabus');
            const savedTracker = localStorage.getItem('jeeTracker');
            const savedHours = localStorage.getItem('jeeStudyHours');
            
            appState.syllabus = savedSyllabus ? JSON.parse(savedSyllabus) : sampleSyllabus;
            appState.trackerData = savedTracker ? JSON.parse(savedTracker) : [];
            appState.studyHours = savedHours ? JSON.parse(savedHours) : Array(90).fill(0);
            
            // Generate tracker data for 90 days if not exists
            if (appState.trackerData.length === 0) {
                generateInitialTrackerData();
            }
        }

        // Generate initial tracker data for 90 days
        function generateInitialTrackerData() {
            const today = new Date();
            appState.trackerData = [];
            
            for (let i = 0; i < appState.totalDays; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() + i);
                
                appState.trackerData.push({
                    day: i + 1,
                    date: date.toLocaleDateString(),
                    dayName: date.toLocaleDateString('en-US', { weekday: 'short' }),
                    physics: "",
                    chemistry: "",
                    math: "",
                    target: "",
                    completed: false,
                    hours: 0,
                    mockScore: "",
                    notes: ""
                });
            }
            
            saveTrackerData();
        }

        // Generate HTML for tracker days
        function generateTrackerDays() {
            const trackerBody = document.getElementById('trackerBody');
            trackerBody.innerHTML = '';
            
            appState.trackerData.forEach((day, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="day-number">${day.day}</td>
                    <td>${day.date}</td>
                    <td>${day.dayName}</td>
                    <td><input type="text" class="topic-input" data-day="${index}" data-subject="physics" value="${day.physics}" placeholder="Physics topic"></td>
                    <td><input type="text" class="topic-input" data-day="${index}" data-subject="chemistry" value="${day.chemistry}" placeholder="Chemistry topic"></td>
                    <td><input type="text" class="topic-input" data-day="${index}" data-subject="math" value="${day.math}" placeholder="Math topic"></td>
                    <td><input type="text" class="target-input" data-day="${index}" value="${day.target}" placeholder="Daily target"></td>
                    <td class="completed">
                        <input type="checkbox" class="checkbox completed-checkbox" data-day="${index}" ${day.completed ? 'checked' : ''}>
                    </td>
                    <td><input type="number" class="hours-input" data-day="${index}" min="0" max="24" value="${day.hours}" step="0.5"></td>
                    <td><input type="text" class="mock-input" data-day="${index}" value="${day.mockScore}" placeholder="Mock score"></td>
                    <td><input type="text" class="notes-input" data-day="${index}" value="${day.notes}" placeholder="Notes"></td>
                `;
                trackerBody.appendChild(row);
            });
        }

        // Render syllabus table
        function renderSyllabus() {
            const syllabusBody = document.getElementById('syllabusBody');
            syllabusBody.innerHTML = '';
            
            appState.syllabus.forEach((topic, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${topic.name}</td>
                    <td>${topic.subject}</td>
                    <td class="priority-${topic.priority.toLowerCase()}">${topic.priority}</td>
                    <td>${topic.days} days</td>
                    <td>${topic.start || 'Not set'}</td>
                    <td>${topic.end || 'Not set'}</td>
                    <td>${topic.status}</td>
                    <td>
                        <button class="secondary small" onclick="assignTopicToDay(${index})">Assign</button>
                        <button class="secondary small" onclick="removeTopic(${index})">Remove</button>
                    </td>
                `;
                syllabusBody.appendChild(row);
            });
        }

        // Update progress statistics
        function updateProgress() {
            // Calculate completion stats
            const totalDays = appState.trackerData.length;
            const completedDays = appState.trackerData.filter(day => day.completed).length;
            const overallProgress = totalDays > 0 ? Math.round((completedDays / totalDays) * 100) : 0;
            
            // Calculate subject progress
            let physicsProgress = 0;
            let chemistryProgress = 0;
            let mathProgress = 0;
            
            appState.trackerData.forEach(day => {
                if (day.physics.trim() !== "" && day.completed) physicsProgress++;
                if (day.chemistry.trim() !== "" && day.completed) chemistryProgress++;
                if (day.math.trim() !== "" && day.completed) mathProgress++;
            });
            
            // Calculate percentages
            const totalWithPhysics = appState.trackerData.filter(day => day.physics.trim() !== "").length;
            const totalWithChemistry = appState.trackerData.filter(day => day.chemistry.trim() !== "").length;
            const totalWithMath = appState.trackerData.filter(day => day.math.trim() !== "").length;
            
            physicsProgress = totalWithPhysics > 0 ? Math.round((physicsProgress / totalWithPhysics) * 100) : 0;
            chemistryProgress = totalWithChemistry > 0 ? Math.round((chemistryProgress / totalWithChemistry) * 100) : 0;
            mathProgress = totalWithMath > 0 ? Math.round((mathProgress / totalWithMath) * 100) : 0;
            
            // Update UI
            document.getElementById('physicsProgress').textContent = `${physicsProgress}%`;
            document.getElementById('chemistryProgress').textContent = `${chemistryProgress}%`;
            document.getElementById('mathProgress').textContent = `${mathProgress}%`;
            document.getElementById('overallProgress').textContent = `${overallProgress}%`;
            
            // Update study hours
            appState.studyHours = appState.trackerData.map(day => parseFloat(day.hours) || 0);
            saveStudyHours();
        }

        // Render charts
        function renderCharts() {
            // Study hours chart
            const hoursCtx = document.getElementById('hoursChart').getContext('2d');
            const days = Array.from({length: appState.totalDays}, (_, i) => i + 1);
            
            if (window.hoursChart) {
                window.hoursChart.destroy();
            }
            
            window.hoursChart = new Chart(hoursCtx, {
                type: 'line',
                data: {
                    labels: days,
                    datasets: [{
                        label: 'Study Hours',
                        data: appState.studyHours,
                        borderColor: '#1a237e',
                        backgroundColor: 'rgba(26, 35, 126, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 12,
                            title: {
                                display: true,
                                text: 'Hours'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Day'
                            }
                        }
                    }
                }
            });
            
            // Progress chart
            const progressCtx = document.getElementById('progressChart').getContext('2d');
            
            if (window.progressChart) {
                window.progressChart.destroy();
            }
            
            // Calculate subject progress for chart
            const completedDays = appState.trackerData.filter(day => day.completed).length;
            const physicsDays = appState.trackerData.filter(day => day.physics.trim() !== "" && day.completed).length;
            const chemistryDays = appState.trackerData.filter(day => day.chemistry.trim() !== "" && day.completed).length;
            const mathDays = appState.trackerData.filter(day => day.math.trim() !== "" && day.completed).length;
            
            window.progressChart = new Chart(progressCtx, {
                type: 'bar',
                data: {
                    labels: ['Overall', 'Physics', 'Chemistry', 'Mathematics'],
                    datasets: [{
                        label: 'Completed Topics',
                        data: [
                            completedDays,
                            physicsDays,
                            chemistryDays,
                            mathDays
                        ],
                        backgroundColor: [
                            '#9c27b0',
                            '#ff5722',
                            '#4caf50',
                            '#2196f3'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Completed Days'
                            }
                        }
                    }
                }
            });
        }

        // Save data to localStorage
        function saveSyllabus() {
            localStorage.setItem('jeeSyllabus', JSON.stringify(appState.syllabus));
        }

        function saveTrackerData() {
            localStorage.setItem('jeeTracker', JSON.stringify(appState.trackerData));
        }

        function saveStudyHours() {
            localStorage.setItem('jeeStudyHours', JSON.stringify(appState.studyHours));
        }

        function loadData() {
            renderSyllabus();
            updateProgress();
        }

        // Setup event listeners
        function setupEventListeners() {
            // Tab switching
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Update active tab
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show corresponding content
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(tabId).classList.add('active');
                    
                    // Refresh charts when progress tab is selected
                    if (tabId === 'progress') {
                        setTimeout(renderCharts, 100);
                    }
                });
            });
            
            // Tracker input changes
            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('topic-input')) {
                    const day = parseInt(e.target.getAttribute('data-day'));
                    const subject = e.target.getAttribute('data-subject');
                    const value = e.target.value;
                    
                    if (subject === 'physics') appState.trackerData[day].physics = value;
                    else if (subject === 'chemistry') appState.trackerData[day].chemistry = value;
                    else if (subject === 'math') appState.trackerData[day].math = value;
                    
                    saveTrackerData();
                    updateProgress();
                }
                
                if (e.target.classList.contains('target-input')) {
                    const day = parseInt(e.target.getAttribute('data-day'));
                    appState.trackerData[day].target = e.target.value;
                    saveTrackerData();
                }
                
                if (e.target.classList.contains('completed-checkbox')) {
                    const day = parseInt(e.target.getAttribute('data-day'));
                    appState.trackerData[day].completed = e.target.checked;
                    saveTrackerData();
                    updateProgress();
                    renderCharts();
                }
                
                if (e.target.classList.contains('hours-input')) {
                    const day = parseInt(e.target.getAttribute('data-day'));
                    const hours = parseFloat(e.target.value) || 0;
                    appState.trackerData[day].hours = hours;
                    appState.studyHours[day] = hours;
                    saveTrackerData();
                    saveStudyHours();
                    updateProgress();
                }
                
                if (e.target.classList.contains('mock-input')) {
                    const day = parseInt(e.target.getAttribute('data-day'));
                    appState.trackerData[day].mockScore = e.target.value;
                    saveTrackerData();
                }
                
                if (e.target.classList.contains('notes-input')) {
                    const day = parseInt(e.target.getAttribute('data-day'));
                    appState.trackerData[day].notes = e.target.value;
                    saveTrackerData();
                }
            });
            
            // Add topic button
            document.getElementById('addTopicBtn').addEventListener('click', function() {
                document.getElementById('topicModal').style.display = 'flex';
            });
            
            document.getElementById('addSyllabusBtn').addEventListener('click', function() {
                document.getElementById('topicModal').style.display = 'flex';
            });
            
            // Close modal
            document.querySelector('.close-modal').addEventListener('click', function() {
                document.getElementById('topicModal').style.display = 'none';
            });
            
            // Topic form submission
            document.getElementById('topicForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const topic = {
                    id: Date.now(),
                    name: document.getElementById('topicName').value,
                    subject: document.getElementById('topicSubject').value,
                    priority: document.getElementById('topicPriority').value,
                    days: parseInt(document.getElementById('topicDays').value),
                    start: "",
                    end: "",
                    status: "Not Started",
                    notes: document.getElementById('topicNotes').value
                };
                
                appState.syllabus.push(topic);
                saveSyllabus();
                renderSyllabus();
                
                // Reset form and close modal
                this.reset();
                document.getElementById('topicModal').style.display = 'none';
                
                alert(`Topic "${topic.name}" added to syllabus!`);
            });
            
            // Reset button
            document.getElementById('resetBtn').addEventListener('click', function() {
                if (confirm('Are you sure you want to reset all data? This cannot be undone.')) {
                    localStorage.clear();
                    appState.syllabus = [...sampleSyllabus];
                    generateInitialTrackerData();
                    generateTrackerDays();
                    renderSyllabus();
                    updateProgress();
                    renderCharts();
                    alert('All data has been reset to default.');
                }
            });
            
            // Export button
            document.getElementById('exportBtn').addEventListener('click', function() {
                const dataStr = JSON.stringify({
                    syllabus: appState.syllabus,
                    tracker: appState.trackerData,
                    studyHours: appState.studyHours,
                    exportDate: new Date().toISOString()
                }, null, 2);
                
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                const exportFileDefaultName = `jee-tracker-${new Date().toISOString().slice(0,10)}.json`;
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
                
                alert('Data exported successfully!');
            });
        }

        // Assign topic to a specific day
        function assignTopicToDay(topicIndex) {
            const topic = appState.syllabus[topicIndex];
            const day = prompt(`Assign "${topic.name}" to which day (1-90)?`, "1");
            
            if (day && day >= 1 && day <= 90) {
                const dayIndex = day - 1;
                
                if (topic.subject === "Physics") {
                    appState.trackerData[dayIndex].physics = topic.name;
                } else if (topic.subject === "Chemistry") {
                    appState.trackerData[dayIndex].chemistry = topic.name;
                } else if (topic.subject === "Mathematics") {
                    appState.trackerData[dayIndex].math = topic.name;
                }
                
                // Update topic status
                appState.syllabus[topicIndex].start = appState.trackerData[dayIndex].date;
                appState.syllabus[topicIndex].status = "Scheduled";
                
                saveTrackerData();
                saveSyllabus();
                generateTrackerDays();
                renderSyllabus();
                updateProgress();
                
                alert(`Topic "${topic.name}" assigned to Day ${day}`);
            }
        }

        // Remove topic from syllabus
        function removeTopic(topicIndex) {
            if (confirm(`Remove "${appState.syllabus[topicIndex].name}" from syllabus?`)) {
                appState.syllabus.splice(topicIndex, 1);
                saveSyllabus();
                renderSyllabus();
            }
        }

        // Close modal when clicking outside
        window.addEventListener('click', function(e) {
            if (e.target.id === 'topicModal') {
                e.target.style.display = 'none';
            }
        });
    </script>
</body>
</html>